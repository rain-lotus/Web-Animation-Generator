<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <style>

        .el {
            background-color: #000;
            width: 100px;
            height: 100px;
        }

    </style>
</head>

<body>
<div id="seekAnim">
    <div class="line">
        <div class="small square el"></div>
    </div>
    <div class="line">
        <div class="small circle el"></div>
    </div>
    <div class="line">
        <div class="small triangle el"></div>
    </div>
    <div class="line player"><input class="progress" step=".001" type="range" min="0" max="100" value="0"></div>

    <div class="line player align-items">
        <button class="play">Play</button>
        <button class="pause">Pause</button>
        <button class="restart">Restart</button>
        <button class="reset">Reset</button>
    </div>
    <button class="test">test</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js"></script>

<script>
    var seekProgressEl = document.querySelector('#seekAnim .progress');

    var seekAnim = anime.timeline({
        easing: 'linear',
        autoplay: false
    });


    document.querySelector('.test').onclick = function(){
        seekAnim = anime.timeline({
            easing: 'linear',
            autoplay: false
        });

        seekAnim
            .add({
                targets: '.square.el',
                translateX: 250,
                easing: 'easeOutExpo',
                opacity: 0
            })
            // .add({
            //     targets: '.circle.el',
            //     translateX: 250,
            //     easing: 'easeOutExpo'
            // })
            // .add({
            //     targets: '.triangle.el',
            //     translateX: 250,
            //     easing: 'easeOutExpo'
            // });

        seekAnim.add({
            //ここ通すとdurationがおかしくなるらしい
            complete: function (anim) {
                console.log(anim.completed);
                seekAnim.seek(0);
            }
        });


    }

    seekProgressEl.addEventListener('input', function () {
        seekAnim.seek(seekAnim.duration * (seekProgressEl.value / 100));
    });

    ['input', 'change'].forEach(function (evt) {
        seekProgressEl.addEventListener(evt, function () {
            seekAnim.seek(seekAnim.duration * (seekProgressEl.value / 100));
        });
    });

    document.querySelector('.play').onclick = function(){
        seekAnim.play();
        console.log(seekAnim.duration);
    };

    document.querySelector('.pause').onclick = seekAnim.pause;
    document.querySelector('.restart').onclick = seekAnim.restart;

    document.querySelector('.reset').onclick = function(){
        seekAnim.seek(0);
    }

</script>
</body>
</html>